\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{mathtools}
\usepackage{latexsym}
\usepackage{amssymb}
\newcommand\Myperm[2][n]{\prescript{#1\mkern-2.5mu}{}P_{#2}}
\newcommand\Mycomb[2][n]{\prescript{#1\mkern-0.5mu}{}C_{#2}}
\begin{document}
~\\
CS 334 Database System ~\\
ps02 ~\\\\
1. \par 
a) $\Pi_{model\_no}(\sigma_{speed \geqslant 3.00} (PCs))$
\par 
b) $\Pi_{company}(\sigma_{hd>=1000}(PCs)\thinspace \Join Manufacturers )$
\par
c) $\Pi_{model\_no, \thinspace price}(\sigma_{company = "Samsung"}(PCs \times \thinspace Smartphones \Join \thinspace Manufacturers))$
\par
d) $\Pi_{company}(\sigma_{device\_type="PC"}(Manufacturers))-\Pi_{company}(\sigma_{device\_type="smartphones"}(Manufacturers))$
\par
e) $\Pi_{r1.hd}(\sigma_{r1.hd=r2.hd \wedge r1.model \ne r2.model }(\rho_{r1}(PCs) \times \rho_{r2}(PCs))$
\par
f) $\Pi_{sp1.model, sp2.model}(\sigma_{sp1.speed=sp2.speed \wedge sp1.ram=sp2.ram \wedge sp1.model>sp2.model}(\rho_{sp1}(Smartphones) \times \rho_{sp2}(Smartphones))$ ~\par
g) Reasonably assuming different types of devices have different model numbers. ~\par
$\rho_{temp}((\Pi_{model}(\sigma_{speed\geqslant 3.00}(PCs)\cup \Pi_{model}(\sigma_{speed\geqslant 3.00}(Smartphones))\Join Manufacturers)$ \par
$\Pi_{company}(\sigma_{temp.company = temp2.company \wedge temp.model \ne temp2.model }(temp \times \rho_{temp2}(temp))$ ~\par
h) \par
$\rho_{all}(\Pi_{model,speed}(PCs) \cup \Pi_{model, speed}(Smartphones))$ \par
$\Pi_{company}(Manufacturers \Join (\Pi_{model}(all)-\Pi_{model}(\sigma_{a1.speed<a2.speed}(\rho_{a1}(all) \times \rho_{a2}(all)))))$
\par
~\\\\
2. \par
a) $temp \leftarrow \Pi_{isbn}(\sigma_{publisher="McGraw-Hill"}(books))$ \par
$\Pi_{name}(member \Join borrowed \Join temp)$ \par
b) $temp \leftarrow \Pi_{isbn}(\sigma_{publisher="McGraw-Hill"}(books)$ \par
$temp2 \leftarrow \sigma_{count>5}(_{memb\_no}\mathcal{G}_{distinct-count(isbn)}(borrowed \Join temp))$ \par
$\Pi_{name, memb\_no}(temp2 \Join member)$ \par
c) $temp \leftarrow memeber \Join borrowed \Join (\sigma_{publisher="McGraw-Hill"}(books))$ \par
$\Pi_{name}(\sigma_{count(isbn) >5}((_{memb\_no}\mathcal{G}_{count-distinct(isbn)}(temp))))$ \par 
d) $temp \leftarrow memeber \Join borrowed \Join books$ \par
$\Pi_{publisher,name,memb\_no}(\sigma_{count(isbn) >5}((_{publisher, memb\_no}\mathcal{G}_{count-distinct(isbn)}(temp))))$ \par 
\end{document}


